{% extends "base.html" %}

{% block title %}Update Order #{{ order.id }} Status{% endblock %}

{% block content %}
<div class="min-h-screen bg-gray-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8">
  <div class="max-w-md w-full bg-white p-8 rounded-lg shadow-xl border border-gray-200">
    <div class="text-center mb-8">
      <h2 class="text-3xl font-extrabold text-gray-900">
        Update Order Status
      </h2>
      <p class="mt-2 text-sm text-gray-600">
        Order ID: <span class="font-semibold text-indigo-600">#{{ order.id }}</span>
      </p>
    </div>

    <form method="POST" class="space-y-6">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

      <div>
        <label for="status" class="block text-sm font-medium text-gray-700 mb-2">Select new status:</label>
        <div class="mt-1">
          <select name="status" id="status" required
            class="block w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm appearance-none pr-10
                   bg-white bg-no-repeat bg-right-center custom-select-arrow"
            style="background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%20viewBox%3D%220%200%20292.4%20292.4%22%3E%3Cpath%20fill%3D%22%236B7280%22%20d%3D%22M287%2C197.35l-14.7%2C14.7c-4%2C4-10.4%2C4-14.4%2C0L146.2%2C84.35l-111.7%2C111.7c-4%2C4-10.4%2C4-14.4%2C0l-14.7-14.7c-4-4-4-10.4%2C0-14.4l129-129c4-4%2C10.4-4%2C14.4%2C0l129%2C129C291%2C186.95%2C291%2C193.35%2C287%2C197.35z%22%2F%3E%3C%2Fsvg%3E'); background-size: 0.8rem 0.8rem; background-position-x: calc(100% - 1rem);">
            <option value="created" {% if order.status == 'created' %}selected{% endif %}>Created (Order Placed)</option>
            <option value="paid" {% if order.status == 'paid' %}selected{% endif %}>Paid (Payment Confirmed)</option>
            <option value="processing" {% if order.status == 'processing' %}selected{% endif %}>Processing (Preparing for Shipping)</option>
            <option value="shipped" {% if order.status == 'shipped' %}selected{% endif %}>Shipped (Out for Delivery)</option>
            <option value="delivered" {% if order.status == 'delivered' %}selected{% endif %}>Delivered (Order Completed)</option>
            <option value="cancelled" {% if order.status == 'cancelled' %}selected{% endif %}>Cancelled (Order Cancelled)</option>
            <option value="refunded" {% if order.status == 'refunded' %}selected{% endif %}>Refunded (Payment Refunded)</option>
          </select>
        </div>
      </div>

      <div class="flex items-center justify-between space-x-4">
        <button type="submit"
          class="flex-1 justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 ease-in-out">
          Update Status
        </button>
        <a href="{{ url_for('admin_dashboard') }}"
          class="flex-1 text-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition duration-150 ease-in-out">
          Cancel
        </a>
      </div>

      {# Optional: Current Status Display #}
      <div class="mt-8 pt-6 border-t border-gray-200 text-center">
        <p class="text-sm font-medium text-gray-700">Current Order Status:</p>
        <p class="text-lg font-semibold mt-1
          {% if order.status == 'created' %}text-blue-500
          {% elif order.status == 'paid' %}text-green-500
          {% elif order.status == 'processing' %}text-yellow-600
          {% elif order.status == 'shipped' %}text-purple-600
          {% elif order.status == 'delivered' %}text-green-700
          {% elif order.status == 'cancelled' %}text-red-600
          {% elif order.status == 'refunded' %}text-red-500
          {% else %}text-gray-500{% endif %}">
          {{ order.status|capitalize }}
        </p>
      </div>

    </form>
  </div>
</div>

<style>
  /* Custom arrow for select dropdown (to override default browser arrow) */
  .custom-select-arrow {
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
  }
</style>
{% endblock %}